<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Tags: html | fasheng的博客]]></title>
  <link href="http://fasheng.github.io/blog/tags/html/atom.xml" rel="self"/>
  <link href="http://fasheng.github.io/"/>
  <updated>2013-09-26T15:52:17+08:00</updated>
  <id>http://fasheng.github.io/</id>
  <author>
    <name><![CDATA[Xu FaSheng]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[org-mode 导出 html 时中文空格问题的临时解决方法]]></title>
    <link href="http://fasheng.github.io/blog/2013-09-25-fix-chinese-space-issue-when-exporting-org-mode-to-html.html"/>
    <updated>2013-09-25T16:51:00+08:00</updated>
    <id>http://fasheng.github.io/blog/fix-chinese-space-issue-when-exporting-org-mode-to-html</id>
    <content type="html"><![CDATA[<p>
最近开始使用 org-mode 写博客，发现导出为 html 后中文之间掺杂着不少多余的空格，对阅读有一定影响，搜索后发现该问题与 w3c 标准有关<sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup><sup>, </sup><sup><a id="fnr.2" name="fnr.2" class="footref" href="#fn.2">2</a></sup>，属于历史遗留问题，短时间内应不会解决。
</p>




<p>
后通过学习 ox-html 源码，找到一种临时解决方法<sup><a id="fnr.3" name="fnr.3" class="footref" href="#fn.3">3</a></sup>，通过给函数
org-html-paragraph 添加 advice，使得导出 html 前自动将段落中的多行中文合并为一行，且不会影响源文件，个人认为还算实用，可供参考（org-mode 8.x
下工作正常）：
</p>




<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #00bfff;">defadvice</span> <span style="color: #daa520;">org-html-paragraph</span> (before fsh-org-html-paragraph-advice
                                      (paragraph contents info) activate)
  <span style="color: #ffe4b5;">"Join consecutive Chinese lines into a single long line without</span>
<span style="color: #ffe4b5;">unwanted space when exporting org-mode to html."</span>
  (<span style="color: #00bfff;">let</span> ((fixed-contents)
        (orig-contents (ad-get-arg 1))
        (reg-han <span style="color: #deb887;">"[[:multibyte:]]"</span>))
    (setq fixed-contents (replace-regexp-in-string
                          (concat <span style="color: #deb887;">"</span><span style="color: #deb887; font-weight: bold;">\\</span><span style="color: #deb887; font-weight: bold;">(</span><span style="color: #deb887;">"</span> reg-han <span style="color: #deb887;">"</span><span style="color: #deb887; font-weight: bold;">\\</span><span style="color: #deb887; font-weight: bold;">)</span><span style="color: #deb887;"> *\n *</span><span style="color: #deb887; font-weight: bold;">\\</span><span style="color: #deb887; font-weight: bold;">(</span><span style="color: #deb887;">"</span> reg-han <span style="color: #deb887;">"</span><span style="color: #deb887; font-weight: bold;">\\</span><span style="color: #deb887; font-weight: bold;">)</span><span style="color: #deb887;">"</span>)
                          <span style="color: #deb887;">"\\1\\2"</span> orig-contents))
    (ad-set-arg 1 fixed-contents)
    ))
</pre>
</div>


<div id="footnotes">
<h2 class="footnotes">&#33050;&#27880;: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p class="footpara">
<a href="http://stackoverflow.com/questions/8550112/prevent-browser-converting-n-between-lines-into-space-for-chinese-characters/8551033#8551033">http://stackoverflow.com/questions/8550112/prevent-browser-converting-n-between-lines-into-space-for-chinese-characters/8551033#8551033</a>
</p></div>

<div class="footdef"><sup><a id="fn.2" name="fn.2" class="footnum" href="#fnr.2">2</a></sup> <p class="footpara">
<a href="http://chenyufei.info/blog/2011-12-23/fix-chinese-newline-becomes-space-in-browser-problem/">http://chenyufei.info/blog/2011-12-23/fix-chinese-newline-becomes-space-in-browser-problem/</a>
</p></div>

<div class="footdef"><sup><a id="fn.3" name="fn.3" class="footnum" href="#fnr.3">3</a></sup> <p class="footpara">
<a href="https://gist.github.com/fasheng/6696398">https://gist.github.com/fasheng/6696398</a>
</p></div>


</div>
</div>

]]></content>
  </entry>
  
</feed>
